{
    "app-id": "org.gnunet.Messenger",
    "runtime": "org.gnome.Platform",
    "runtime-version": "49",
    "sdk": "org.gnome.Sdk",
    "command": "messenger-gtk",
    "finish-args": [
        "--device=dri",
        "--share=ipc",
        "--socket=wayland",
        "--socket=fallback-x11",
        "--share=network",
        "--socket=pulseaudio",
        "--filesystem=xdg-desktop:ro",
        "--filesystem=xdg-documents:ro",
        "--filesystem=xdg-download:rw",
        "--filesystem=xdg-music:ro",
        "--filesystem=xdg-pictures:ro",
        "--filesystem=xdg-public-share:ro",
        "--filesystem=xdg-videos:ro",
        "--filesystem=xdg-templates:ro",
        "--filesystem=xdg-run/pipewire-0"
    ],
    "cleanup": [
        "/include",
        "/lib/pkgconfig",
        "/share/aclocal",
        "/share/man",
        "/share/info",
        "*.la",
        "*.a"
    ],
    "modules": [
        {
            "name": "recutils",
            "buildsystem": "autotools",
            "build-options": {
                "cflags": "-Wno-error=incompatible-pointer-types -Wno-error=implicit-function-declaration"
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/recutils/recutils-1.9.tar.gz",
                    "sha512": "775b3b8925a4e5c6f04c6376291b966bdc271f172be2bca06b1f02155ecba12d916c22219f85fe0393f7f9f200f3788ab5fa5d522da2b84b2a0c0ec198318809",
                    "x-checker-data": {
                        "type": "rotating-url",
                        "url": "https://ftp.gnu.org/gnu/recutils/recutils-1.9.tar.gz",
                        "pattern": "https://ftp.gnu.org/gnu/recutils/recutils-([0-9.]+).tar.gz"
                    }
                }
            ]
        },
        {
            "name": "jansson",
            "buildsystem": "autotools",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/akheron/jansson/releases/download/v2.14.1/jansson-2.14.1.tar.gz",
                    "sha512": "4c6fdf2efa74788fd1711d44293991346d70d22178109b3309ada079f59c30bd716f91e976235c40c640b177d82919a0e13d264ee714d359db266e2f1078c953",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/akheron/jansson/releases/latest",
                        "version-query": ".tag_name | sub(\"^v\"; \"\")",
                        "url-query": ".assets[] | select(.name==\"jansson-\" + $version + \".tar.gz\") | .browser_download_url"
                    }
                }
            ]
        },
        {
            "name": "libsodium",
            "buildsystem": "autotools",
			"build-options": {
				"arch": {
					"aarch64": {
						"cflags": "-march=armv8-a+crypto+aes"
					}
				}
			},
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/jedisct1/libsodium/releases/download/1.0.21-RELEASE/libsodium-1.0.21.tar.gz",
                    "sha512": "ee8cc2f3f5707b172bf75d8c04afbd5f0c83c6f94dbab3f988f07aab716d96f1662556a59e09b3d83c3bd5c22f59327ad95937bf499d523c86146f4df830f777",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/jedisct1/libsodium/releases/latest",
                        "version-query": ".tag_name | sub(\"-RELEASE$\"; \"\")",
                        "url-query": ".assets[] | select(.name==\"libsodium-\" + $version + \".tar.gz\") | .browser_download_url",
                        "is-important": true
                    }
                }
            ]
        },
        {
            "name": "libtool",
            "buildsystem": "autotools",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/libtool/libtool-2.5.4.tar.gz",
                    "sha512": "60599f5c3168a287fe3a35062fd2e32e0b73433fce820bfd18d28b0e3bd7a8fefde6d6f0505fbbc2d664119ab7c539269184993843289932c895847ea1ab9f04",
                    "x-checker-data": {
                        "type": "rotating-url",
                        "url": "https://ftp.gnu.org/gnu/libtool/libtool-2.5.4.tar.gz",
                        "pattern": "https://ftp.gnu.org/gnu/libtool/libtool-([0-9.]+).tar.gz"
                    }
                }
            ]
        },
        {
            "name": "libmicrohttpd",
            "buildsystem": "autotools",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/libmicrohttpd/libmicrohttpd-1.0.2.tar.gz",
                    "sha512": "7092f307a00ba04b539be79a7c94ddf9b4b6e43343a66da49c6602fa860f77cf7f9017d7e40f9b7400d85a828a503248eb12dd121413aad68133003a20bb2c4a",
                    "x-checker-data": {
                        "type": "rotating-url",
                        "url": "https://ftp.gnu.org/gnu/libmicrohttpd/libmicrohttpd-1.0.2.tar.gz",
                        "pattern": "https://ftp.gnu.org/gnu/libmicrohttpd/libmicrohttpd-([0-9.]+).tar.gz"
                    }
                }
            ]
        },
        {
            "name": "libunistring",
            "buildsystem": "autotools",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/libunistring/libunistring-1.4.tar.gz",
                    "sha512": "ddab67454b3b5abd3008728d1dd8220bc2b3611bb3e49b0cfda84968dfb7dd6402ca652af2cc604794fb364f2a53e77f7108fa962d2c17e46b329ddec2dd0976",
                    "x-checker-data": {
                        "type": "rotating-url",
                        "url": "https://ftp.gnu.org/gnu/libunistring/libunistring-1.4.tar.gz",
                        "pattern": "https://ftp.gnu.org/gnu/libunistring/libunistring-([0-9.]+).tar.gz"
                    }
                }
            ]
        },
        {
            "name": "gnunet",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/gnunet/gnunet-0.26.2.tar.gz",
                    "sha512": "a10b749df28d422507acdd7fd27846ec255cf5f1d5404b88746326238a098fba14b39716c3bf024313381dcd0c6a6556279cd7737bffbf856071e7f23ae69365",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.com/gnunet-messenger/gnunet/-/tags",
                        "version-pattern": ">v([\\d\\.]+)</a>",
                        "url-template": "https://ftp.gnu.org/gnu/gnunet/gnunet-$version.tar.gz",
                        "is-important": true
                    }
                }
            ]
        },
        {
            "name": "libgnunetchat",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/gnunet/libgnunetchat-0.6.1.tar.gz",
                    "sha512": "fe18b18cbac15b357a108d3bf1ef7927ae489060db18cb8cb72f3b1fb4209d52b45864d6819b5791c06243492278b3d98afe89f295966097eac917d12d56928e",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.com/gnunet-messenger/libgnunetchat/-/tags",
                        "version-pattern": ">v([\\d\\.]+)</a>",
                        "url-template": "https://ftp.gnu.org/gnu/gnunet/libgnunetchat-$version.tar.gz",
                        "is-important": true
                    }
                }
            ]
        },
        {
            "name": "libqrencode",
            "buildsystem": "autotools",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/fukuchi/libqrencode/archive/refs/tags/v4.1.1.tar.gz",
                    "sha512": "584106e7bcaaa1ef2efe63d653daad38d4ff436eb4b185a1db3c747169c1ffa74149c3b1329bb0b8ae007903db0a7034aabf135cc196d91a37b5c61348154a65",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/fukuchi/libqrencode/releases/latest",
                        "version-query": ".tag_name | sub(\"^v\"; \"\")",
                        "url-query": ".tag_name | sub(\"^v\"; \"https://github.com/fukuchi/libqrencode/archive/refs/tags/v\") | sub(\"$\"; \".tar.gz\")"
                    }
                }
            ]
        },
        {
            "name": "zbar",
            "buildsystem": "autotools",
            "config-opts": [
                "--with-x=no",
                "--enable-pthread=yes",
                "--enable-doc=no",
                "--enable-video=yes",
                "--with-jpeg=yes",
                "--with-gtk=no",
                "--with-gir=no",
                "--with-qt=no",
                "--with-python=no",
                "--with-java=no",
                "--with-dbus=no",
                "--without-imagemagick"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://linuxtv.org/downloads/zbar/zbar-0.23.93.tar.gz",
                    "sha512": "61ac8d50c5d236f996cf60221198e3b9357329a9ecda67b29495001f59055ae0124fb1dd70c6ec075eb96eb2ef42c22604a447c9203126f9d0f8108a4e268056",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/mchehab/zbar/releases/latest",
                        "version-query": ".tag_name",
                        "url-query": ".tag_name | sub(\"^\"; \"https://linuxtv.org/downloads/zbar/zbar-\") | sub(\"$\"; \".tar.gz\")"
                    }
                }
            ]
        },
        {
            "name": "openh264",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/cisco/openh264/archive/refs/tags/2.5.1.tar.gz",
                    "sha512": "ef37f1ba3cdd73d344087e9fe7aa073ad3b354b53e8561a699e42a75af7fdd3429aa6d10cc6f933ca88b761ddebfe842513009d08848780add18525b4b2ca1ca",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/cisco/openh264/releases/latest",
                        "version-query": ".tag_name",
                        "url-query": ".tag_name | sub(\"^v\"; \"https://github.com/cisco/openh264/archive/refs/tags/\") | sub(\"$\"; \".tar.gz\")"
                    }
                }
            ]
        },
        {
            "name": "gstreamer",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://gstreamer.freedesktop.org/src/gstreamer/gstreamer-1.27.90.tar.xz",
                    "sha256": "e6379b7413e72b0fd6e734d3a2ae875edd58108f1f4315bfe47907909f41bc80",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.freedesktop.org/gstreamer/gstreamer/-/tags",
                        "version-pattern": "Release ([\\d\\.]+)",
                        "url-template": "https://gstreamer.freedesktop.org/src/gstreamer/gstreamer-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "gst-plugins-base",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://gstreamer.freedesktop.org/src/gst-plugins-base/gst-plugins-base-1.27.90.tar.xz",
                    "sha256": "30c8e6f98274717efaaa8f54e3700d72c1ba8977678c38f15b51c6006bfad12f",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.freedesktop.org/gstreamer/gstreamer/-/tags",
                        "version-pattern": "Release ([\\d\\.]+)",
                        "url-template": "https://gstreamer.freedesktop.org/src/gst-plugins-base/gst-plugins-base-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "gst-plugins-good",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://gstreamer.freedesktop.org/src/gst-plugins-good/gst-plugins-good-1.27.90.tar.xz",
                    "sha256": "6ae5c65ef3a00f0ca34d1bb8011be42240a590f8cd04690ad28d6fa331bc5f44",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.freedesktop.org/gstreamer/gstreamer/-/tags",
                        "version-pattern": "Release ([\\d\\.]+)",
                        "url-template": "https://gstreamer.freedesktop.org/src/gst-plugins-good/gst-plugins-good-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "gst-plugins-bad",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://gstreamer.freedesktop.org/src/gst-plugins-bad/gst-plugins-bad-1.27.90.tar.xz",
                    "sha256": "60d9fcc725bb56f4559b4925e6f469cd43bb96ec1bfd7554295e2b8c53ba9d4b",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.freedesktop.org/gstreamer/gstreamer/-/tags",
                        "version-pattern": "Release ([\\d\\.]+)",
                        "url-template": "https://gstreamer.freedesktop.org/src/gst-plugins-bad/gst-plugins-bad-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "gst-plugins-ugly",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://gstreamer.freedesktop.org/src/gst-plugins-ugly/gst-plugins-ugly-1.27.90.tar.xz",
                    "sha256": "51514565c7864eec2d3e134439d42ec0a720e8d015436179abec9dca945522c5",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.freedesktop.org/gstreamer/gstreamer/-/tags",
                        "version-pattern": "Release ([\\d\\.]+)",
                        "url-template": "https://gstreamer.freedesktop.org/src/gst-plugins-ugly/gst-plugins-ugly-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "gst-libav",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://gstreamer.freedesktop.org/src/gst-libav/gst-libav-1.27.90.tar.xz",
                    "sha256": "4ff894d57a1328424892f155aa919ee13568437e05457046858186e9ccd2ba59",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.freedesktop.org/gstreamer/gstreamer/-/tags",
                        "version-pattern": "Release ([\\d\\.]+)",
                        "url-template": "https://gstreamer.freedesktop.org/src/gst-libav/gst-libav-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "libportal",
            "buildsystem": "meson",
            "config-opts": [
                "-Dbackend-gtk3=enabled",
                "-Dbackend-gtk4=disabled",
                "-Dbackend-qt5=disabled",
                "-Dportal-tests=false",
                "-Ddocs=false",
                "-Dtests=false"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/flatpak/libportal/releases/download/0.9.1/libportal-0.9.1.tar.xz",
                    "sha256": "de801ee349ed3c255a9af3c01b1a401fab5b3fc1c35eb2fd7dfb35d4b8194d7f",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://github.com/flatpak/libportal/releases",
                        "version-pattern": "libportal-([\\d\\.]+).tar.xz",
                        "url-template": "https://github.com/flatpak/libportal/releases/download/$version/libportal-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "messenger-gtk",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/gnunet/messenger-gtk-0.11.0.tar.gz",
                    "sha512": "9f0fb3d72a785d4b6a077e684ba7ae0ce4353f728414a73f08fad6a2773de0d92a7514d0d701d7b1af93e096501fa1b7852760fdede7ce688504444f7f69b582",
                    "x-checker-data": {
                        "type": "html",
                        "url": "https://gitlab.com/gnunet-messenger/messenger-gtk/-/tags",
                        "version-pattern": ">v([\\d\\.]+)</a>",
                        "url-template": "https://ftp.gnu.org/gnu/gnunet/messenger-gtk-$version.tar.gz",
                        "is-main-source": true
                    }
                }
            ]
        }
    ]
}
